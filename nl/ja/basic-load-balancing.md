---

copyright:
  years: 2017, 2018
lastupdated: "2018-11-07"

keywords: basics, load balancing

subcollection: loadbalancer-service

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}
{:important: .important}
{:note: .note}

# {{site.data.keyword.loadbalancer_full}} の実行の基本
{: #performing-ibm-cloud-load-balancer-basics}

{{site.data.keyword.loadbalancer_full}} サービスは、同じデータ・センター内にローカルに常駐する複数のサーバー・インスタンス (ベア・メタルおよび仮想サーバー) 間でトラフィックを分散します。

## パブリック・ロード・バランサー
{: #public-load-balancer}

ロード・バランサー・サービス・インスタンスには、パブリックにアクセス可能な完全修飾ドメイン・ネームが割り当てられます。 ロード・バランサー・サービスの後ろでホストされているアプリケーションにアクセスするには、このドメイン名を使用する必要があります。 このドメイン・ネームは、1 つ以上のパブリック IP アドレスに登録できます。 パブリック IP アドレスとその数は、エンド・ユーザーに対して透過的であるメンテナンスとスケーリングのアクティビティーに基づいて、時間の経過と共に変化する可能性があります。 アプリケーションをホストするバックエンド・コンピュート・インスタンスは、IBM Cloud のプライベート・ネットワーク上になければなりません。

良い慣例として、直接のパブリック接続を必要としている場合を除いて、バックエンド・サーバーを「プライベート専用」としてプロビジョンすることをお勧めします。 この慣例は、セキュリティーの向上に役立ち、ユーザーのパブリック IP アドレスを保護します。 これらのバックエンド・サーバーでホストされているアプリケーションはロード・バランサーを使用してパブリック・ネットワーク経由でアクセス可能であることに変わりはありません。
{: note}  

ロード・バランサー・サービス・インスタンスの作成時に、ロード・バランサーのパブリック IP アドレスを IBM システム・プール (デフォルト) またはアカウントのパブリック VLAN から割り当てることができます。

## 内部ロード・バランサー
{: #internal-load-balancer}

内部ロード・バランサーは IBM Cloud プライベート・ネットワーク内でのみアクセス可能です。

パブリック・ロード・バランサー同様、内部ロード・バランサーのサービス・インスタンスにも完全修飾ドメイン・ネームが割り当てられます。 ただし、このドメイン・ネームは 1 つ以上のプライベート IP アドレスに登録されます。

パブリック・ロード・バランサー同様、プライベート IP アドレスとその数は、エンド・ユーザーに対して透過的であるメンテナンスとスケーリングのアクティビティーに基づいて、時間の経過と共に変化する可能性があります。

アプリケーションをホストするバックエンド・コンピュート・インスタンスも、IBM Cloud プライベート・ネットワーク上になければなりません。
{: note}

## フロントエンド・アプリケーションおよびバックエンド・アプリケーションのポート/プロトコル
{: #front-end-and-back-end-application-ports-protocols}

最大 10 個のフロントエンド・アプリケーションのポート (プロトコル) を定義し、それらをバックエンド・アプリケーション・サーバー上の各ポート (プロトコル) にマップすることができます。 ロード・バランサー・サービス・インスタンスに割り当てられている完全修飾ドメイン・ネームとフロントエンド・アプリケーションのポートは、外部の世界に公開されます。 着信ユーザー要求は、これらのポートで受信されます。

一方、バックエンド・ポートは、内部でのみ認識されます。 これらのバックエンド・ポートは、フロントエンド・ポートと同じ場合もあれば同じでない場合もあります。 例えば、ロード・バランサーは、フロントエンド・ポート 80 で着信 Web/HTTP トラフィックを受信するよう構成され、一方でバックエンド・サーバーは、カスタム・ポート 81 で listen している場合があります。

サポートされるフロントエンドのポート/プロトコルは HTTP、HTTPS、および TCP です。 サポートされるバックエンドのポート/プロトコルも HTTP、HTTPS、および TCP です。 バックエンド・サーバーとのプレーン・テキスト HTTP 通信を可能にするには、着信 HTTPS トラフィックをロード・バランサーで終了する必要があります。 バックエンド・プロトコルが HTTPS の場合、トラフィックはロード・バランサーとバックエンド・サーバーの間で暗号化されます。

### 考慮事項
{: #considerations}

* 初期構成中に定義できるのは、最大 2 個のフロントエンド・ポートのみになります。 ロード・バランサーが作成されたら、ポート構成を編集して追加のポート (最大 10 個のポート) を定義できます。
* 10 個のフロントエンド・ポートはすべて、同じバックエンド・サーバー・インスタンスのセットにマップする必要があります。
* ロード・バランサーの後ろに配置できるサーバー・インスタンスの最大数は 50 個です。
* ポート範囲 56500 から 56520 は、管理目的用に予約されており、フロントエンド仮想ポートとして使用できません。
* TCP ポート 56501 は、管理に使用されます。 パブリック VLAN からロード・バランサーのパブリック IP アドレスを割り当てる場合は、パブリック VLAN にデプロイしたファイアウォールによって、この管理ポートへのトラフィックおよびアプリケーションのポートへのトラフィックがブロックされないようにしてください。 これは、ロード・バランサーのパブリック IP アドレスを割り当てるために IBM システム・プール・オプションを選択した場合には必要ありません。

## ロード・バランシングの方式
{: #load-balancing-methods}

バックエンド・アプリケーション・サーバー間でトラフィックを分散するために、以下の 3 つのロード・バランシング方式が使用可能です。

* **ラウンドロビン:** ラウンドロビンは、デフォルトのロード・バランシング方式です。 この方式では、ロード・バランサーは、着信クライアント接続をラウンドロビン形式でバックエンド・サーバーに転送します。 その結果として、すべてのバックエンド・サーバーは、ほぼ同数のクライアント接続を受信します。

* **重み付きラウンドロビン:** この方式では、ロード・バランサーは、バックエンド・サーバーに割り当てられた重みに比例して、着信クライアント接続をバックエンド・サーバーに転送します。 各サーバーには、デフォルトの重み 50 が割り当てられます。この重みは、0 から 100 の間の任意の値にカスタマイズできます。

	例えば、3 台のアプリケーション・サーバー A、B、および C があり、それらの重みがそれぞれ 60、60、および 30 にカスタマイズされている場合、サーバー A と B は同数の接続を受信し、サーバー C はその半数の接続を受信します。


	サーバーの重みを「0」にリセットするということは、そのサーバーには新しい接続が転送されず、既存のトラフィックはすべて、アクティブである限りフローし続けることを意味します。 重み「0」を使用すると、サーバーを正常終了し、サービス・ローテーションからそのサーバーを削除するのに役立ちます。{: note}

	サーバーの重みの値は、「重み付きラウンドロビン」方式でのみ利用可能です。 「ラウンドロビン」および「最小接続」のロード・バランシング方式では無視されます。{: note}

* **最小接続:** この方式では、指定された時間に最も少ない数の接続にサービス提供しているサーバー・インスタンスが次のクライアント接続を受信します。

## 水平スケーリング
{: #horizontal-scaling}

ロード・バランサーは、負荷に応じて自動的にその容量を調整します。 調整が行われるときに、ロード・バランサーの DNS 名に関連付けられている IP アドレスの数が変わるのが分かることもあります。
